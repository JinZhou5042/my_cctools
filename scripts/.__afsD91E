#!/bin/bash

help_info="
Usage: bash $0 [-opt]
opt:
	-h                   print help information
	-p  <port>           the working port
	-ql <query_length>   the length of sequence for each query
	-qc <query_count>    the number of queries for each task
	-tc <task_count>     the number of tasks in total
	-wc <worker_count>   the number of workers
	-name <task_name>    the name of this execution
	-plot <perf_file>    plot from task performance information file, once choose this option, you can only plot a figure from given vine_info file

example:
	bash $0 -p 9123 -ql 4 -qc 10 -tc 100000 -wc 10 -name task1
	bash $0 -plot /afs/crc.nd.edu/user/j/jzhou24/scripts/vine-run-info/most-recent/vine-logs
"

blast_dir="/afs/crc.nd.edu/user/j/jzhou24/cctools/taskvine/src/examples/"
blast_path="${blast_dir}vine_example_blast.py"

while [[ "$#" -gt 0 ]]; do
	case $1 in
		-h)
			printf "%s\n" "$help_info"
			shift
			exit 0
			;;
		-plot)
			python $blast_path --plot "$2"
			exit 0
			;;			
		-p)
			port="$2"
			shift 2
			;;
		-ql)
			ql="$2"
			shift 2
			;;
		-qc)
			qc="$2"
			shift 2
			;;
		-tc)
			tc="$2"
			shift 2
			;;
		-name)
			name="$2"
			shift 2
			;;
		-wc)
			wc="$2"
			shift 2
			;;
		*)
			echo "Invalid Option: $1"
			exit 1
			;;
	esac
done	


# blast_dir="/afs/crc.nd.edu/user/j/jzhou24/cctools/taskvine/src/examples/"
# blast_path="${blast_dir}vine_example_blast.py"

# blast_path="vine_example_blast.py"
echo "port=$port query_length=$ql query_count=$qc task_count=$tc"
python $blast_path --port $port --query-length $ql --query-count $qc --task-count $tc --worker-count $wc --name $name

# bash plot_most_recent.sh
